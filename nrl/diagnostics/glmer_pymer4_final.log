2025-08-16 22:49:37,522 - INFO - --- Starting Python Script using Pymer4 (2025-08-16 22:49:37.522327) ---
2025-08-16 22:49:37,522 - INFO - R console output will be redirected to this log.
2025-08-16 22:49:37,556 - INFO - Successfully connected to database 'rugby' on localhost:5432
2025-08-16 22:49:37,556 - INFO - Fetching data from database...
2025-08-16 22:49:37,559 - INFO - Fetched data shape: (350, 7)
2025-08-16 22:49:37,559 - INFO - Preprocessing data...
2025-08-16 22:49:37,559 - INFO - Converting column 'game_id' to string type before category conversion for R compatibility.
2025-08-16 22:49:37,560 - INFO - Converted column 'field' to category.
2025-08-16 22:49:37,561 - INFO - Converted column 'team' to category.
2025-08-16 22:49:37,561 - INFO - Converted column 'opponent' to category.
2025-08-16 22:49:37,561 - INFO - Converted column 'game_id' to category.
2025-08-16 22:49:37,562 - INFO - Checked 'gs' and 'w' columns: all values are finite.
2025-08-16 22:49:37,562 - INFO - Using 350 rows for model fitting after weight filtering.
2025-08-16 22:49:37,562 - INFO - Using factor name map for parameter levels: {'game_id': 'game_id', 'opponent': 'defense', 'team': 'offense', 'field': 'field'}
2025-08-16 22:49:37,563 - INFO - Extracting parameter levels...
2025-08-16 22:49:37,563 - INFO - Mapping internal column 'team' to parameter 'offense' for levels table.
2025-08-16 22:49:37,563 - INFO - Mapping internal column 'opponent' to parameter 'defense' for levels table.
2025-08-16 22:49:37,564 - INFO - Parameter levels DataFrame shape: (211, 3)
2025-08-16 22:49:37,565 - INFO - Parameter levels head:
   parameter    type     level
19   defense  random   Broncos
20   defense  random  Bulldogs
21   defense  random   Cowboys
22   defense  random  Dolphins
23   defense  random   Dragons
2025-08-16 22:49:37,565 - INFO - Writing parameter levels to database table nrl._parameter_levels...
2025-08-16 22:49:37,625 - INFO - Successfully wrote parameter levels.
2025-08-16 22:49:37,625 - INFO - Defining and fitting the GLMM using Pymer4...
2025-08-16 22:49:37,625 - INFO - Model formula: gs ~ field + (1|team) + (1|opponent) + (1|game_id)
2025-08-16 22:49:37,626 - INFO - Starting model fit (this may take time)...
2025-08-16 22:49:38,572 - WARNING - R[write to console]: In addition: 
2025-08-16 22:49:38,573 - WARNING - R[write to console]: Warning messages:

2025-08-16 22:49:38,573 - WARNING - R[write to console]: 1: 
2025-08-16 22:49:38,573 - WARNING - R[write to console]: In (function (package, help, pos = 2, lib.loc = NULL, character.only = FALSE,  :
2025-08-16 22:49:38,573 - WARNING - R[write to console]: 
 
2025-08-16 22:49:38,573 - WARNING - R[write to console]:  library ‘/usr/lib/R/site-library’ contains no packages

2025-08-16 22:49:38,573 - WARNING - R[write to console]: 2: 
2025-08-16 22:49:38,573 - WARNING - R[write to console]: In (function (package, help, pos = 2, lib.loc = NULL, character.only = FALSE,  :
2025-08-16 22:49:38,573 - WARNING - R[write to console]: 
 
2025-08-16 22:49:38,573 - WARNING - R[write to console]:  library ‘/usr/lib/R/site-library’ contains no packages

2025-08-16 22:49:38,573 - WARNING - R[write to console]: 3: 
2025-08-16 22:49:38,573 - WARNING - R[write to console]: In (function (package, help, pos = 2, lib.loc = NULL, character.only = FALSE,  :
2025-08-16 22:49:38,573 - WARNING - R[write to console]: 
 
2025-08-16 22:49:38,573 - WARNING - R[write to console]:  library ‘/usr/lib/R/site-library’ contains no packages

2025-08-16 22:49:38,573 - WARNING - R[write to console]: 4: 
2025-08-16 22:49:38,573 - WARNING - R[write to console]: In (function (package, help, pos = 2, lib.loc = NULL, character.only = FALSE,  :
2025-08-16 22:49:38,573 - WARNING - R[write to console]: 
 
2025-08-16 22:49:38,573 - WARNING - R[write to console]:  library ‘/usr/lib/R/site-library’ contains no packages

2025-08-16 22:49:38,573 - WARNING - R[write to console]: 5: 
2025-08-16 22:49:38,573 - WARNING - R[write to console]: In (function (package, help, pos = 2, lib.loc = NULL, character.only = FALSE,  :
2025-08-16 22:49:38,573 - WARNING - R[write to console]: 
 
2025-08-16 22:49:38,573 - WARNING - R[write to console]:  library ‘/usr/lib/R/site-library’ contains no packages

2025-08-16 22:49:38,735 - WARNING - R[write to console]: In addition: 
2025-08-16 22:49:38,735 - WARNING - R[write to console]: Warning message:

2025-08-16 22:49:38,735 - WARNING - R[write to console]: In Matrix.DeprecatedCoerce(cd1, cd2) :
2025-08-16 22:49:38,735 - WARNING - R[write to console]: 
 
2025-08-16 22:49:38,735 - WARNING - R[write to console]:  'as(<dsyMatrix>, "dpoMatrix")' is deprecated.
Use 'as(., "posdefMatrix")' instead.
See help("Deprecated") and help("Matrix-deprecated").

2025-08-16 22:49:38,761 - INFO - Model fitting complete.
2025-08-16 22:49:38,761 - INFO - --- Model Fit Summary (from Pymer4) ---
2025-08-16 22:49:38,765 - INFO -                    Estimate  2.5_ci  97.5_ci     SE  Z-stat  P-val  Sig
2025-08-16 22:49:38,765 - INFO - (Intercept)           2.991   2.880    3.103  0.057  52.428    0.0  ***
2025-08-16 22:49:38,765 - INFO - fieldoffense_home     0.149   0.105    0.194  0.023   6.545    0.0  ***
2025-08-16 22:49:38,765 - INFO - --- End Model Fit Summary ---
2025-08-16 22:49:38,765 - INFO - Extracting model results (Fixed and Random Effects)...
2025-08-16 22:49:38,765 - INFO - Using factor name map for random effects: {'game_id': 'game_id', 'opponent': 'defense', 'team': 'offense'}
2025-08-16 22:49:38,765 - INFO - Attempting to process model.coefs. Type: <class 'pandas.core.frame.DataFrame'>
2025-08-16 22:49:38,765 - INFO - model.coefs is a DataFrame. Extracting estimates.
2025-08-16 22:49:38,765 - INFO - Extracted 2 fixed effect(s) from model.coefs.
2025-08-16 22:49:38,765 - INFO - Attempting to process model.ranef. Type: <class 'list'>
2025-08-16 22:49:38,765 - INFO - model.ranef is a list with expected length 3. Processing elements.
2025-08-16 22:49:38,765 - INFO - Processing ranef element 0 for internal factor 'game_id'. Type: <class 'pandas.core.frame.DataFrame'>
2025-08-16 22:49:38,768 - INFO - Extracted 175 levels for random effect corresponding to 'game_id'.
2025-08-16 22:49:38,768 - INFO - Processing ranef element 1 for internal factor 'opponent'. Type: <class 'pandas.core.frame.DataFrame'>
2025-08-16 22:49:38,768 - INFO - Mapped internal factor 'opponent' to output factor 'defense'.
2025-08-16 22:49:38,768 - INFO - Extracted 17 levels for random effect corresponding to 'opponent'.
2025-08-16 22:49:38,768 - INFO - Processing ranef element 2 for internal factor 'team'. Type: <class 'pandas.core.frame.DataFrame'>
2025-08-16 22:49:38,768 - INFO - Mapped internal factor 'team' to output factor 'offense'.
2025-08-16 22:49:38,769 - INFO - Extracted 17 levels for random effect corresponding to 'team'.
2025-08-16 22:49:38,769 - INFO - Finished processing ranef list. Total random effect levels extracted: 209
2025-08-16 22:49:38,769 - INFO - Successfully extracted 211 total factor level estimates into results_list.
2025-08-16 22:49:38,769 - INFO - Preparing combined DataFrame for database export...
2025-08-16 22:49:38,769 - INFO - Combined results DataFrame shape: (211, 4)
2025-08-16 22:49:38,770 - INFO - Combined results head:
              factor    type              level  estimate
0        (Intercept)   fixed        (Intercept)  2.991454
1  fieldoffense_home   fixed  fieldoffense_home  0.149457
2            game_id  random               1592 -0.102108
3            game_id  random               1593  0.110000
4            game_id  random               1594  0.209853
2025-08-16 22:49:38,771 - INFO - Combined results tail:
      factor    type         level  estimate
206  offense  random        Sharks  0.051457
207  offense  random         Storm  0.264183
208  offense  random        Titans -0.065692
209  offense  random      Warriors -0.048398
210  offense  random  Wests Tigers -0.125869
2025-08-16 22:49:38,771 - INFO - Writing combined results to database table nrl._basic_factors...
2025-08-16 22:49:38,834 - INFO - Successfully wrote combined results.
2025-08-16 22:49:38,834 - INFO - Results extraction and writing complete.
2025-08-16 22:49:38,834 - INFO - Closing database connection if open.
2025-08-16 22:49:38,834 - INFO - Database connection closed.
2025-08-16 22:49:38,834 - INFO - --- Python Script Finished (2025-08-16 22:49:38.834619) ---
2025-08-16 22:49:39,013 - INFO - Embedded R ended.
2025-08-16 22:49:39,013 - INFO - Embedded R already ended.
